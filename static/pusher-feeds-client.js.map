{"version":3,"file":"pusher-feeds-client.js","sources":["../node_modules/pusher-platform-js/target/pusher-platform.js","../src/constants.js","../src/utils.js","../src/feed.js","../src/token-provider.js","../src/pusher-feeds.js"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"PusherPlatform\"] = factory();\n\telse\n\t\troot[\"PusherPlatform\"] = factory();\n})(this, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// identity function for calling harmony imports with the correct context\n/******/ \t__webpack_require__.i = function(value) { return value; };\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 5);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar subscription_1 = __webpack_require__(1);\nvar resumable_subscription_1 = __webpack_require__(2);\nfunction responseHeadersObj(headerStr) {\n    var headers = {};\n    if (!headerStr) {\n        return headers;\n    }\n    var headerPairs = headerStr.split('\\u000d\\u000a');\n    for (var i = 0; i < headerPairs.length; i++) {\n        var headerPair = headerPairs[i];\n        var index = headerPair.indexOf('\\u003a\\u0020');\n        if (index > 0) {\n            var key = headerPair.substring(0, index);\n            var val = headerPair.substring(index + 2);\n            headers[key] = val;\n        }\n    }\n    return headers;\n}\nexports.responseHeadersObj = responseHeadersObj;\nvar ErrorResponse = (function (_super) {\n    __extends(ErrorResponse, _super);\n    function ErrorResponse(statusCode, headers, info) {\n        var _this = _super.call(this, \"ErroResponse: \" + statusCode + \": \" + info + \" \\n Headers: \" + JSON.stringify(headers)) || this;\n        _this.statusCode = statusCode;\n        _this.headers = headers;\n        _this.info = info;\n        return _this;\n    }\n    ErrorResponse.fromXHR = function (xhr) {\n        return new ErrorResponse(xhr.status, responseHeadersObj(xhr.getAllResponseHeaders()), xhr.responseText);\n    };\n    return ErrorResponse;\n}(Error));\nexports.ErrorResponse = ErrorResponse;\nvar NetworkError = (function (_super) {\n    __extends(NetworkError, _super);\n    function NetworkError(error) {\n        var _this = _super.call(this) || this;\n        _this.error = error;\n        return _this;\n    }\n    return NetworkError;\n}(Error));\nexports.NetworkError = NetworkError;\n// Follows https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/readyState\nvar XhrReadyState;\n(function (XhrReadyState) {\n    XhrReadyState[XhrReadyState[\"UNSENT\"] = 0] = \"UNSENT\";\n    XhrReadyState[XhrReadyState[\"OPENED\"] = 1] = \"OPENED\";\n    XhrReadyState[XhrReadyState[\"HEADERS_RECEIVED\"] = 2] = \"HEADERS_RECEIVED\";\n    XhrReadyState[XhrReadyState[\"LOADING\"] = 3] = \"LOADING\";\n    XhrReadyState[XhrReadyState[\"DONE\"] = 4] = \"DONE\";\n})(XhrReadyState = exports.XhrReadyState || (exports.XhrReadyState = {}));\nvar BaseClient = (function () {\n    function BaseClient(options) {\n        this.options = options;\n        var cluster = options.cluster.replace(/\\/$/, '');\n        this.baseURL = (options.encrypted !== false ? \"https\" : \"http\") + \"://\" + cluster;\n        this.XMLHttpRequest = options.XMLHttpRequest || window.XMLHttpRequest;\n    }\n    BaseClient.prototype.request = function (options) {\n        var xhr = this.createXHR(this.baseURL, options);\n        return new Promise(function (resolve, reject) {\n            xhr.onreadystatechange = function () {\n                if (xhr.readyState === 4) {\n                    if (xhr.status === 200) {\n                        resolve(xhr.responseText);\n                    }\n                    else {\n                        reject(ErrorResponse.fromXHR(xhr));\n                    }\n                }\n            };\n            xhr.send(JSON.stringify(options.body));\n        });\n    };\n    BaseClient.prototype.newSubscription = function (subOptions) {\n        return new subscription_1.Subscription(this.createXHR(this.baseURL, {\n            method: \"SUBSCRIBE\",\n            path: subOptions.path,\n            headers: {},\n            body: null,\n        }), subOptions);\n    };\n    BaseClient.prototype.newResumableSubscription = function (subOptions) {\n        var _this = this;\n        return new resumable_subscription_1.ResumableSubscription(function () {\n            return _this.createXHR(_this.baseURL, {\n                method: \"SUBSCRIBE\",\n                path: subOptions.path,\n                headers: {},\n                body: null,\n            });\n        }, subOptions);\n    };\n    BaseClient.prototype.createXHR = function (baseURL, options) {\n        var XMLHttpRequest = this.XMLHttpRequest;\n        var xhr = new XMLHttpRequest();\n        var path = options.path.replace(/^\\/+/, \"\");\n        var endpoint = baseURL + \"/\" + path;\n        xhr.open(options.method.toUpperCase(), endpoint, true);\n        if (options.body) {\n            xhr.setRequestHeader(\"content-type\", \"application/json\");\n        }\n        if (options.jwt) {\n            xhr.setRequestHeader(\"authorization\", \"Bearer \" + options.jwt);\n        }\n        for (var key in options.headers) {\n            xhr.setRequestHeader(key, options.headers[key]);\n        }\n        return xhr;\n    };\n    return BaseClient;\n}());\nexports.BaseClient = BaseClient;\n\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar base_client_1 = __webpack_require__(0);\nvar SubscriptionState;\n(function (SubscriptionState) {\n    SubscriptionState[SubscriptionState[\"UNOPENED\"] = 0] = \"UNOPENED\";\n    SubscriptionState[SubscriptionState[\"OPENING\"] = 1] = \"OPENING\";\n    SubscriptionState[SubscriptionState[\"OPEN\"] = 2] = \"OPEN\";\n    SubscriptionState[SubscriptionState[\"ENDING\"] = 3] = \"ENDING\";\n    SubscriptionState[SubscriptionState[\"ENDED\"] = 4] = \"ENDED\"; // called onEnd() or onError(err)\n})(SubscriptionState = exports.SubscriptionState || (exports.SubscriptionState = {}));\n// Asserts that the subscription state is one of the specified values,\n// otherwise logs the current value.\nfunction assertState(stateEnum, states) {\n    var _this = this;\n    if (states === void 0) { states = []; }\n    var check = states.some(function (state) { return stateEnum[state] === _this.state; });\n    var expected = states.join(', ');\n    var actual = stateEnum[this.state];\n    console.assert(check, \"Expected this.state to be \" + expected + \" but it is \" + actual);\n    if (!check) {\n        console.trace();\n    }\n}\nexports.assertState = assertState;\n;\n// Callback pattern: (onOpen onEvent* (onEnd|onError)) | onError\n// A call to `unsubscribe()` will call `options.onEnd()`;\n// a call to `unsubscribe(someError)` will call `options.onError(someError)`.\nvar Subscription = (function () {\n    function Subscription(xhr, options) {\n        var _this = this;\n        this.xhr = xhr;\n        this.options = options;\n        this.state = SubscriptionState.UNOPENED;\n        this.gotEOS = false;\n        this.lastNewlineIndex = 0;\n        this.assertState = assertState.bind(this, SubscriptionState);\n        if (options.lastEventId) {\n            this.xhr.setRequestHeader(\"Last-Event-Id\", options.lastEventId);\n        }\n        this.xhr.onreadystatechange = function () {\n            if (_this.xhr.readyState === base_client_1.XhrReadyState.UNSENT ||\n                _this.xhr.readyState === base_client_1.XhrReadyState.OPENED ||\n                _this.xhr.readyState === base_client_1.XhrReadyState.HEADERS_RECEIVED) {\n                // Too early for us to do anything.\n                _this.assertState(['OPENING']);\n            }\n            else if (_this.xhr.readyState === base_client_1.XhrReadyState.LOADING) {\n                // The headers have loaded and we have partial body text.\n                // We can get this one multiple times.\n                _this.assertState(['OPENING', 'OPEN', 'ENDING']);\n                if (_this.xhr.status === 200) {\n                    // We've received a successful response header.\n                    // The partial body text is a partial JSON message stream.\n                    if (_this.state === SubscriptionState.OPENING) {\n                        _this.state = SubscriptionState.OPEN;\n                        if (_this.options.onOpen) {\n                            _this.options.onOpen();\n                        }\n                    }\n                    _this.assertState(['OPEN', 'ENDING']);\n                    var err = _this.onChunk(); // might transition our state from OPEN -> ENDING\n                    _this.assertState(['OPEN', 'ENDING']);\n                    if (err != null) {\n                        _this.xhr.abort();\n                        // Because we abort()ed, we will get no more calls to our onreadystatechange handler,\n                        // and so we will not call the event handler again.\n                        // Finish with options.onError instead of the options.onEnd.\n                        _this.state = SubscriptionState.ENDED;\n                        if (_this.options.onError) {\n                            _this.options.onError(err);\n                        }\n                    }\n                    else {\n                        // We consumed some response text, and all's fine. We expect more text.\n                    }\n                }\n                else {\n                    // Error response. Wait until the response completes (state 4) before erroring.\n                    _this.assertState(['OPENING']);\n                }\n            }\n            else if (_this.xhr.readyState === base_client_1.XhrReadyState.DONE) {\n                // This is the last time onreadystatechange is called.\n                if (_this.xhr.status === 200) {\n                    if (_this.state === SubscriptionState.OPENING) {\n                        _this.state = SubscriptionState.OPEN;\n                        if (_this.options.onOpen) {\n                            _this.options.onOpen();\n                        }\n                    }\n                    _this.assertState(['OPEN', 'ENDING']);\n                    var err = _this.onChunk();\n                    if (err !== null && err !== undefined) {\n                        _this.state = SubscriptionState.ENDED;\n                        if (_this.options.onError) {\n                            _this.options.onError(err);\n                        }\n                    }\n                    else if (_this.state !== SubscriptionState.ENDING) {\n                        if (_this.options.onError) {\n                            _this.options.onError(new Error(\"HTTP response ended without receiving EOS message\"));\n                        }\n                    }\n                    else {\n                        // Stream ended normally.\n                        if (_this.options.onEnd) {\n                            _this.options.onEnd();\n                        }\n                    }\n                }\n                else {\n                    // The server responded with a bad status code (finish with onError).\n                    // Finish with an error.\n                    _this.assertState(['OPENING', 'OPEN', 'ENDED']);\n                    if (_this.state === SubscriptionState.ENDED) {\n                        // We aborted the request deliberately, and called onError/onEnd elsewhere.\n                    }\n                    else {\n                        _this.options.onError(base_client_1.ErrorResponse.fromXHR(_this.xhr));\n                    }\n                }\n            }\n        };\n        xhr.onerror = function (event) {\n            if (_this.options.onError) {\n                _this.options.onError(new base_client_1.NetworkError(event));\n            }\n        };\n    }\n    Subscription.prototype.open = function (jwt) {\n        if (this.state !== SubscriptionState.UNOPENED) {\n            throw new Error(\"Called .open() on Subscription object in unexpected state: \" + this.state);\n        }\n        this.state = SubscriptionState.OPENING;\n        if (jwt) {\n            this.xhr.setRequestHeader(\"authorization\", \"Bearer \" + jwt);\n        }\n        this.xhr.send();\n    };\n    // calls options.onEvent 0+ times, then possibly returns an error.\n    // idempotent.\n    Subscription.prototype.onChunk = function () {\n        this.assertState(['OPEN']);\n        var response = this.xhr.responseText;\n        var newlineIndex = response.lastIndexOf(\"\\n\");\n        if (newlineIndex > this.lastNewlineIndex) {\n            var rawEvents = response.slice(this.lastNewlineIndex, newlineIndex).split(\"\\n\");\n            this.lastNewlineIndex = newlineIndex;\n            for (var _i = 0, rawEvents_1 = rawEvents; _i < rawEvents_1.length; _i++) {\n                var rawEvent = rawEvents_1[_i];\n                if (rawEvent.length === 0) {\n                    continue; // FIXME why? This should be a protocol error\n                }\n                var data = JSON.parse(rawEvent);\n                var err = this.onMessage(data);\n                if (err != null) {\n                    return err;\n                }\n            }\n        }\n    };\n    // calls options.onEvent 0+ times, then returns an Error or null\n    Subscription.prototype.onMessage = function (message) {\n        this.assertState(['OPEN']);\n        if (this.gotEOS) {\n            return new Error(\"Got another message after EOS message\");\n        }\n        if (!Array.isArray(message)) {\n            return new Error(\"Message is not an array\");\n        }\n        if (message.length < 1) {\n            return new Error(\"Message is empty array\");\n        }\n        switch (message[0]) {\n            case 0:\n                return null;\n            case 1:\n                return this.onEventMessage(message);\n            case 255:\n                return this.onEOSMessage(message);\n            default:\n                return new Error(\"Unknown Message: \" + JSON.stringify(message));\n        }\n    };\n    // EITHER calls options.onEvent, OR returns an error\n    Subscription.prototype.onEventMessage = function (eventMessage) {\n        this.assertState(['OPEN']);\n        if (eventMessage.length !== 4) {\n            return new Error(\"Event message has \" + eventMessage.length + \" elements (expected 4)\");\n        }\n        var _ = eventMessage[0], id = eventMessage[1], headers = eventMessage[2], body = eventMessage[3];\n        if (typeof id !== \"string\") {\n            return new Error(\"Invalid event ID in message: \" + JSON.stringify(eventMessage));\n        }\n        if (typeof headers !== \"object\" || Array.isArray(headers)) {\n            return new Error(\"Invalid event headers in message: \" + JSON.stringify(eventMessage));\n        }\n        if (this.options.onEvent) {\n            this.options.onEvent({ eventId: id, headers: headers, body: body });\n        }\n    };\n    // calls options.onEvent 0+ times, then possibly returns an error\n    Subscription.prototype.onEOSMessage = function (eosMessage) {\n        this.assertState(['OPEN']);\n        if (eosMessage.length !== 4) {\n            return new Error(\"EOS message has \" + eosMessage.length + \" elements (expected 4)\");\n        }\n        var _ = eosMessage[0], statusCode = eosMessage[1], headers = eosMessage[2], info = eosMessage[3];\n        if (typeof statusCode !== \"number\") {\n            return new Error(\"Invalid EOS Status Code\");\n        }\n        if (typeof headers !== \"object\" || Array.isArray(headers)) {\n            return new Error(\"Invalid EOS Headers\");\n        }\n        this.state = SubscriptionState.ENDING;\n        return new base_client_1.ErrorResponse(statusCode, headers, info);\n    };\n    Subscription.prototype.unsubscribe = function (err) {\n        this.state = SubscriptionState.ENDED;\n        this.xhr.abort();\n        if (err) {\n            if (this.options.onError) {\n                this.options.onError(err);\n            }\n        }\n        else {\n            if (this.options.onEnd) {\n                this.options.onEnd();\n            }\n        }\n    };\n    return Subscription;\n}());\nexports.Subscription = Subscription;\n\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar subscription_1 = __webpack_require__(1);\nvar retry_strategy_1 = __webpack_require__(6);\nvar ResumableSubscriptionState;\n(function (ResumableSubscriptionState) {\n    ResumableSubscriptionState[ResumableSubscriptionState[\"UNOPENED\"] = 0] = \"UNOPENED\";\n    ResumableSubscriptionState[ResumableSubscriptionState[\"OPENING\"] = 1] = \"OPENING\";\n    ResumableSubscriptionState[ResumableSubscriptionState[\"OPEN\"] = 2] = \"OPEN\";\n    ResumableSubscriptionState[ResumableSubscriptionState[\"ENDING\"] = 3] = \"ENDING\";\n    ResumableSubscriptionState[ResumableSubscriptionState[\"ENDED\"] = 4] = \"ENDED\"; // called onEnd() or onError(err)\n})(ResumableSubscriptionState = exports.ResumableSubscriptionState || (exports.ResumableSubscriptionState = {}));\n// Asserts that the subscription state is one of the specified values,\n// otherwise logs the current value.\nfunction assertState(stateEnum, states) {\n    var _this = this;\n    if (states === void 0) { states = []; }\n    var check = states.some(function (state) { return stateEnum[state] === _this.state; });\n    var expected = states.join(', ');\n    var actual = stateEnum[this.state];\n    console.assert(check, \"Expected this.state to be \" + expected + \" but it is \" + actual);\n    if (!check) {\n        console.trace();\n    }\n}\nexports.assertState = assertState;\n;\n// pattern of callbacks: ((onOpening (onOpen onEvent*)?)? (onError|onEnd)) | onError\nvar ResumableSubscription = (function () {\n    function ResumableSubscription(xhrSource, options) {\n        this.xhrSource = xhrSource;\n        this.options = options;\n        this.state = ResumableSubscriptionState.UNOPENED;\n        this.retryStrategy = new retry_strategy_1.ExponentialBackoffRetryStrategy({});\n        this.assertState = assertState.bind(this, ResumableSubscriptionState);\n        this.lastEventIdReceived = options.lastEventId;\n        this.logger = options.logger;\n    }\n    ResumableSubscription.prototype.tryNow = function () {\n        var _this = this;\n        this.state = ResumableSubscriptionState.OPENING;\n        var newXhr = this.xhrSource();\n        this.subscription = new subscription_1.Subscription(newXhr, {\n            path: this.options.path,\n            lastEventId: this.lastEventIdReceived,\n            onOpen: function () {\n                _this.assertState(['OPENING']);\n                _this.state = ResumableSubscriptionState.OPEN;\n                if (_this.options.onOpen) {\n                    _this.options.onOpen();\n                }\n            },\n            onEvent: function (event) {\n                _this.assertState(['OPEN']);\n                if (_this.options.onEvent) {\n                    _this.options.onEvent(event);\n                }\n                console.assert(!_this.lastEventIdReceived ||\n                    parseInt(event.eventId) > parseInt(_this.lastEventIdReceived), 'Expected the current event id to be larger than the previous one');\n                _this.lastEventIdReceived = event.eventId;\n            },\n            onEnd: function () {\n                _this.state = ResumableSubscriptionState.ENDED;\n                if (_this.options.onEnd) {\n                    _this.options.onEnd();\n                }\n            },\n            onError: function (error) {\n                _this.state = ResumableSubscriptionState.OPENING;\n                _this.retryStrategy.attemptRetry(error)\n                    .then(function () { _this.tryNow; })\n                    .catch(function (error) {\n                    _this.state = ResumableSubscriptionState.ENDED;\n                    if (_this.options.onError) {\n                        _this.options.onError(error);\n                    }\n                });\n            },\n            logger: this.logger\n        });\n        if (this.options.tokenProvider) {\n            this.options.tokenProvider.fetchToken().then(function (jwt) {\n                _this.subscription.open(jwt);\n            }).catch(function (err) {\n                if (_this.options.onError)\n                    _this.options.onError(err);\n            });\n        }\n        else {\n            this.subscription.open(null);\n        }\n    };\n    ResumableSubscription.prototype.open = function () {\n        this.tryNow();\n    };\n    ResumableSubscription.prototype.unsubscribe = function () {\n        this.subscription.unsubscribe(); // We'll get onEnd and bubble this up\n    };\n    return ResumableSubscription;\n}());\nexports.ResumableSubscription = ResumableSubscription;\n\n\n/***/ }),\n/* 3 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar LogLevel;\n(function (LogLevel) {\n    LogLevel[LogLevel[\"VERBOSE\"] = 1] = \"VERBOSE\";\n    LogLevel[LogLevel[\"DEBUG\"] = 2] = \"DEBUG\";\n    LogLevel[LogLevel[\"INFO\"] = 3] = \"INFO\";\n    LogLevel[LogLevel[\"WARNING\"] = 4] = \"WARNING\";\n    LogLevel[LogLevel[\"ERROR\"] = 5] = \"ERROR\";\n})(LogLevel = exports.LogLevel || (exports.LogLevel = {}));\nvar DefaultLogger = (function () {\n    function DefaultLogger(treshold) {\n        if (treshold === void 0) { treshold = 2; }\n        this.treshold = treshold;\n    }\n    DefaultLogger.prototype.log = function (level, message, error) {\n        if (level >= this.treshold) {\n            console.log(message);\n            if (error) {\n                console.log(error);\n            }\n        }\n    };\n    DefaultLogger.prototype.verbose = function (message, error) {\n        this.log(LogLevel.VERBOSE, message, error);\n    };\n    DefaultLogger.prototype.debug = function (message, error) {\n        this.log(LogLevel.DEBUG, message, error);\n    };\n    DefaultLogger.prototype.info = function (message, error) {\n        this.log(LogLevel.INFO, message, error);\n    };\n    DefaultLogger.prototype.warn = function (message, error) {\n        this.log(LogLevel.WARNING, message, error);\n    };\n    DefaultLogger.prototype.error = function (message, error) {\n        this.log(LogLevel.ERROR, message, error);\n    };\n    return DefaultLogger;\n}());\nexports.DefaultLogger = DefaultLogger;\nvar EmptyLogger = (function () {\n    function EmptyLogger() {\n    }\n    EmptyLogger.prototype.verbose = function (message, error) { };\n    ;\n    EmptyLogger.prototype.debug = function (message, error) { };\n    ;\n    EmptyLogger.prototype.info = function (message, error) { };\n    ;\n    EmptyLogger.prototype.warn = function (message, error) { };\n    ;\n    EmptyLogger.prototype.error = function (message, error) { };\n    ;\n    return EmptyLogger;\n}());\nexports.EmptyLogger = EmptyLogger;\n\n\n/***/ }),\n/* 4 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar __assign = (this && this.__assign) || Object.assign || function(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n        s = arguments[i];\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n            t[p] = s[p];\n    }\n    return t;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar base_client_1 = __webpack_require__(0);\nvar logger_1 = __webpack_require__(3);\nvar DEFAULT_CLUSTER = \"api-ceres.kube.pusherplatform.io\";\nvar App = (function () {\n    function App(options) {\n        this.serviceId = options.serviceId;\n        this.tokenProvider = options.tokenProvider;\n        this.client = options.client || new base_client_1.BaseClient({\n            cluster: options.cluster || DEFAULT_CLUSTER,\n            encrypted: options.encrypted\n        });\n        if (options.logger) {\n            this.logger = options.logger;\n        }\n        else {\n            this.logger = new logger_1.DefaultLogger();\n        }\n    }\n    App.prototype.request = function (options) {\n        var _this = this;\n        options.path = this.absPath(options.path);\n        var tokenProvider = options.tokenProvider || this.tokenProvider;\n        if (!options.jwt && tokenProvider) {\n            return tokenProvider.fetchToken().then(function (jwt) {\n                return _this.client.request(__assign({ jwt: jwt }, options));\n            });\n        }\n        else {\n            return this.client.request(options);\n        }\n    };\n    App.prototype.subscribe = function (options) {\n        options.path = this.absPath(options.path);\n        options.logger = this.logger;\n        var subscription = this.client.newSubscription(options);\n        var tokenProvider = options.tokenProvider || this.tokenProvider;\n        if (options.jwt) {\n            subscription.open(options.jwt);\n        }\n        else if (tokenProvider) {\n            tokenProvider.fetchToken().then(function (jwt) {\n                subscription.open(jwt);\n            }).catch(function (err) {\n                subscription.unsubscribe(err);\n            });\n        }\n        else {\n            subscription.open(null);\n        }\n        return subscription;\n    };\n    App.prototype.resumableSubscribe = function (options) {\n        options.logger = this.logger;\n        options.path = this.absPath(options.path);\n        var tokenProvider = options.tokenProvider || this.tokenProvider;\n        var resumableSubscription = this.client.newResumableSubscription(__assign({ tokenProvider: tokenProvider }, options));\n        resumableSubscription.open();\n        return resumableSubscription;\n    };\n    App.prototype.absPath = function (relativePath) {\n        return (\"/apps/\" + this.serviceId + \"/\" + relativePath).replace(/\\/+/g, \"/\").replace(/\\/+$/, \"\");\n    };\n    return App;\n}());\nexports.default = App;\n\n\n/***/ }),\n/* 5 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar app_1 = __webpack_require__(4);\nvar base_client_1 = __webpack_require__(0);\nvar resumable_subscription_1 = __webpack_require__(2);\nvar subscription_1 = __webpack_require__(1);\nexports.default = {\n    App: app_1.default,\n    BaseClient: base_client_1.BaseClient,\n    ResumableSubscription: resumable_subscription_1.ResumableSubscription,\n    Subscription: subscription_1.Subscription\n};\n\n\n/***/ }),\n/* 6 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar base_client_1 = __webpack_require__(0);\nvar logger_1 = __webpack_require__(3);\nvar Retry = (function () {\n    function Retry(waitTimeMilis) {\n        this.waitTimeMilis = waitTimeMilis;\n    }\n    return Retry;\n}());\nexports.Retry = Retry;\nvar DoNotRetry = (function () {\n    function DoNotRetry(error) {\n        this.error = error;\n    }\n    return DoNotRetry;\n}());\nexports.DoNotRetry = DoNotRetry;\nvar ExponentialBackoffRetryStrategy = (function () {\n    function ExponentialBackoffRetryStrategy(options) {\n        this.limit = 6;\n        this.retryCount = 0;\n        this.maxBackoffMilis = 30000;\n        this.currentBackoffMilis = 1000;\n        if (options.limit)\n            this.limit = options.limit;\n        if (options.initialBackoffMilis)\n            this.currentBackoffMilis = options.initialBackoffMilis;\n        if (options.maxBackoffMilis)\n            this.maxBackoffMilis = options.maxBackoffMilis;\n        if (options.logger) {\n            this.logger = options.logger;\n        }\n        else {\n            this.logger = new logger_1.DefaultLogger();\n        }\n    }\n    ExponentialBackoffRetryStrategy.prototype.shouldRetry = function (error) {\n        this.logger.debug(this.constructor.name + \":  Error received\", error);\n        if (this.retryCount >= this.limit && this.limit > 0) {\n            this.logger.debug(this.constructor.name + \":  Retry count is over the maximum limit: \" + this.limit);\n            return new DoNotRetry(error);\n        }\n        var retryable = this.isRetryable(error);\n        if (retryable.isRetryable) {\n            if (retryable.backoffMillis) {\n                this.retryCount += 1;\n                return new Retry(retryable.backoffMillis);\n            }\n            else {\n                this.currentBackoffMilis = this.calulateMilisToRetry();\n                this.retryCount += 1;\n                this.logger.debug(this.constructor.name + \": Will attempt to retry in: \" + this.currentBackoffMilis);\n                return new Retry(this.currentBackoffMilis);\n            }\n        }\n        else {\n            this.logger.debug(this.constructor.name + \": Error is not retryable\", error);\n            return new DoNotRetry(error);\n        }\n    };\n    ExponentialBackoffRetryStrategy.prototype.attemptRetry = function (error) {\n        var _this = this;\n        return new Promise(function (resolve, reject) {\n            var shouldRetry = _this.shouldRetry(error);\n            if (shouldRetry instanceof DoNotRetry) {\n                reject(error);\n            }\n            else if (shouldRetry instanceof Retry) {\n                window.setTimeout(resolve, shouldRetry.waitTimeMilis);\n            }\n        });\n    };\n    ExponentialBackoffRetryStrategy.prototype.isRetryable = function (error) {\n        var retryable = {\n            isRetryable: false\n        };\n        //We allow network errors\n        if (error instanceof base_client_1.NetworkError)\n            retryable.isRetryable = true;\n        else if (error instanceof base_client_1.ErrorResponse) {\n            //Only retry after is allowed\n            if (error.headers[\"retry-after\"]) {\n                retryable.isRetryable = true;\n                retryable.backoffMillis = parseInt(error.headers[\"retry-after\"]) * 1000;\n            }\n        }\n        return retryable;\n    };\n    ExponentialBackoffRetryStrategy.prototype.calulateMilisToRetry = function () {\n        if (this.currentBackoffMilis >= this.maxBackoffMilis || this.currentBackoffMilis * 2 >= this.maxBackoffMilis) {\n            return this.maxBackoffMilis;\n        }\n        if (this.retryCount > 0) {\n            return this.currentBackoffMilis * 2;\n        }\n        return this.currentBackoffMilis;\n    };\n    return ExponentialBackoffRetryStrategy;\n}());\nexports.ExponentialBackoffRetryStrategy = ExponentialBackoffRetryStrategy;\n\n\n/***/ })\n/******/ ]);\n});","export const servicePath = \"services/feeds/v1/\";\nexport const feedIdRegex = /^[a-zA-Z0-9-]+$/;\nexport const serviceIdRegex = /^[a-zA-Z0-9-]+$/;\nexport const cacheExpiryTolerance = 60;\nexport const defaultAuthEndpoint = \"/feeds/tokens\";\n","export function parseResponse(promise) {\n  return new Promise((resolve, reject) => {\n    promise.then(response => {\n      try {\n        resolve(JSON.parse(response));\n      } catch (err) {\n        reject(err);\n      }\n    }).catch(reject);\n  });\n}\n\nexport function urlEncode(data) {\n  return Object.keys(data)\n    .filter(key => data[key] !== undefined)\n    .map(key => `${ key }=${ encodeURIComponent(data[key]) }`)\n    .join(\"&\");\n}\n\nexport function queryString(data) {\n  const encodedData = urlEncode(data);\n  return encodedData ? `?${ encodedData }` : \"\";\n}\n","import { servicePath } from \"./constants\";\nimport { parseResponse, queryString } from \"./utils\";\n\nexport default class Feed {\n  constructor({ app, feedId, readTokenProvider }) {\n    this.app = app;\n    this.feedId = feedId;\n    this.readTokenProvider = readTokenProvider;\n  }\n\n  subscribe(options = {}) {\n    return this.app.resumableSubscribe({\n      ...options,\n      path: this.itemsPath + queryString({\n        tail_size: options.tailSize,\n      }),\n      tokenProvider: this.readTokenProvider,\n      onEvent: options.onItem,\n    });\n  }\n\n  getHistory({ fromId, limit = 50 } = {}) {\n    return parseResponse(this.app.request({\n      method: \"GET\",\n      path: this.itemsPath + queryString({\n        from_id: fromId,\n        limit: limit,\n      }),\n      tokenProvider: this.readTokenProvider,\n    }));\n  }\n\n  get itemsPath() {\n    return `${ servicePath }/feeds/${ this.feedId }/items`;\n  }\n}\n","import { cacheExpiryTolerance, defaultAuthEndpoint } from \"./constants\";\nimport { urlEncode } from \"./utils\";\n\nfunction now() {\n  return Math.floor(Date.now() / 1000);\n}\n\nexport default class TokenProvider {\n  constructor({ authEndpoint, authData }) {\n    this.authEndpoint = authEndpoint || defaultAuthEndpoint;\n    this.authData = authData;\n  }\n\n  fetchToken() {\n    if (this.cacheIsStale) {\n      return this.makeAuthRequest().then(responseBody => {\n        this.cache(responseBody.access_token, responseBody.expires_in);\n        return this.cachedToken;\n      });\n    }\n    return Promise.resolve(this.cachedToken);\n  }\n\n  get cacheIsStale() {\n    return !this.cachedToken || now() > this.cacheValidUntil;\n  }\n\n  cache(token, expiresIn) {\n    this.cachedToken = token;\n    this.cacheValidUntil = now() + expiresIn - cacheExpiryTolerance;\n  }\n\n  makeAuthRequest() {\n    return new Promise((resolve, reject) => {\n      const xhr = new XMLHttpRequest();\n      xhr.open(\"POST\", this.authEndpoint);\n      xhr.addEventListener(\"load\", () => {\n        if (xhr.status === 200) {\n          resolve(JSON.parse(xhr.responseText));\n        } else {\n          reject(new Error(`Couldn't get token from ${ this.authEndpoint }; got ${ xhr.status } ${ xhr.statusText }.`));\n        }\n      });\n      xhr.setRequestHeader(\"content-type\", \"application/x-www-form-urlencoded\");\n      xhr.send(urlEncode({\n        ...this.authData,\n        grant_type: \"client_credentials\",\n      }));\n    });\n  }\n}\n","import PusherPlatform from \"pusher-platform-js\";\nimport Feed from \"./feed\";\nimport TokenProvider from \"./token-provider\";\nimport { servicePath, feedIdRegex, serviceIdRegex } from \"./constants\";\nimport { parseResponse, queryString } from \"./utils\";\n\nexport default class PusherFeeds {\n  constructor({ serviceId, cluster, authData = {}, authEndpoint } = {}) {\n    this.authData = authData;\n    this.authEndpoint = authEndpoint;\n    if (!serviceId || !serviceId.match(serviceIdRegex)) {\n      throw new TypeError(`Invalid serviceId: ${ serviceId }`);\n    }\n    this.listTokenProvider = new TokenProvider({\n      authEndpoint: this.authEndpoint,\n      authData: {\n        ...this.authData,\n        path: \"feeds\",\n        action: \"READ\",\n      }\n    });\n    this.firehoseTokenProvider = new TokenProvider({\n      authEndpoint: this.authEndpoint,\n      authData: {\n        ...this.authData,\n        path: \"firehose/items\",\n        action: \"READ\",\n      }\n    });\n    this.app = new PusherPlatform.App({ serviceId, cluster });\n  }\n\n  list({ prefix, limit } = {}) {\n    return parseResponse(this.app.request({\n      method: \"GET\",\n      path: `${ servicePath }/feeds` + queryString({ prefix, limit }),\n      tokenProvider: this.listTokenProvider,\n    }));\n  }\n\n  feed(feedId) {\n    if (!feedId || !feedId.match(feedIdRegex)) {\n      throw new TypeError(`Invalid feedId: ${ feedId }`);\n    }\n    const readTokenProvider = feedId.startsWith(\"private-\") ? new TokenProvider({\n      authEndpoint:  this.authEndpoint,\n      authData: {\n        ...this.authData,\n        path: `feeds/${ feedId }/items`,\n        action: \"READ\",\n      }\n    }) : null;\n    return new Feed({\n      app: this.app,\n      feedId,\n      readTokenProvider,\n    });\n  }\n\n  firehose(options) {\n    // TODO wrap onEvent to expose onPublish, onSubscribe, and onUnsubscribe\n    return this.app.subscribe({\n      ...options,\n      path: `${ servicePath }/firehose/items`,\n      tokenProvider: this.firehoseTokenProvider,\n    });\n  }\n}\n"],"names":["webpackUniversalModuleDefinition","root","factory","module","this","modules","installedModules","__webpack_require__","moduleId","exports","i","l","call","m","c","value","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","getDefault","getModuleExports","object","property","prototype","hasOwnProperty","p","s","__extends","extendStatics","setPrototypeOf","__proto__","Array","b","__","constructor","create","subscription_1","resumable_subscription_1","responseHeadersObj","headerStr","headers","headerPairs","split","length","headerPair","index","indexOf","key","substring","val","ErrorResponse","_super","statusCode","info","_this","JSON","stringify","fromXHR","xhr","status","getAllResponseHeaders","responseText","Error","NetworkError","error","XhrReadyState","BaseClient","options","cluster","replace","baseURL","encrypted","XMLHttpRequest","window","request","createXHR","Promise","resolve","reject","onreadystatechange","readyState","send","body","newSubscription","subOptions","Subscription","path","newResumableSubscription","ResumableSubscription","endpoint","open","method","toUpperCase","setRequestHeader","jwt","base_client_1","SubscriptionState","assertState","stateEnum","states","check","some","state","expected","join","actual","assert","trace","UNOPENED","gotEOS","lastNewlineIndex","bind","lastEventId","UNSENT","OPENED","HEADERS_RECEIVED","LOADING","OPENING","OPEN","onOpen","err","onChunk","abort","ENDED","onError","DONE","undefined","ENDING","onEnd","onerror","event","response","newlineIndex","lastIndexOf","rawEvents","slice","_i","rawEvents_1","rawEvent","data","parse","onMessage","message","isArray","onEventMessage","onEOSMessage","eventMessage","_","id","onEvent","eventId","eosMessage","unsubscribe","retry_strategy_1","ResumableSubscriptionState","xhrSource","retryStrategy","ExponentialBackoffRetryStrategy","lastEventIdReceived","logger","tryNow","newXhr","subscription","parseInt","attemptRetry","then","catch","tokenProvider","fetchToken","LogLevel","DefaultLogger","treshold","log","level","verbose","VERBOSE","debug","DEBUG","INFO","warn","WARNING","ERROR","EmptyLogger","__assign","assign","t","arguments","logger_1","DEFAULT_CLUSTER","App","serviceId","client","absPath","subscribe","resumableSubscribe","resumableSubscription","relativePath","default","app_1","Retry","waitTimeMilis","DoNotRetry","limit","retryCount","maxBackoffMilis","currentBackoffMilis","initialBackoffMilis","shouldRetry","retryable","isRetryable","backoffMillis","calulateMilisToRetry","setTimeout","servicePath","feedIdRegex","serviceIdRegex","cacheExpiryTolerance","defaultAuthEndpoint","parseResponse","promise","urlEncode","keys","filter","map","encodeURIComponent","queryString","encodedData","Feed","app","feedId","readTokenProvider","itemsPath","tailSize","onItem","fromId","now","Math","floor","Date","TokenProvider","authEndpoint","authData","cacheIsStale","makeAuthRequest","cache","responseBody","access_token","expires_in","cachedToken","token","expiresIn","cacheValidUntil","addEventListener","statusText","PusherFeeds","match","TypeError","listTokenProvider","firehoseTokenProvider","PusherPlatform","prefix","startsWith"],"mappings":"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"}